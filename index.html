<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Document Pro - Professional photo and document optimizer for passports, visas, and more. Easy, fast, and reliable.">
    <meta name="keywords" content="document optimizer, passport photo, visa photo, photo editing, professional documents">
    <meta name="author" content="Document Pro">
    <title>Document Pro - Professional Photo & Document Optimizer</title>
    <link rel="icon" type="image/png" href="favicon.png"> <!-- Replace with actual favicon -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Hero Section -->
        <section class="hero">
            <h1>Create Perfect Documents in Seconds</h1>
            <p>Optimize your photos and documents for passports, visas, and more with ease.</p>
            <button class="btn" onclick="scrollToSignIn()">Get Started Now</button>
        </section>

        <!-- Sign In Section -->
        <section class="header" id="signIn">
            <h2>üìÑ Document Pro</h2>
            <p>Sign in to optimize your professional photos and documents</p>

            <div id="signInSection" style="margin-top: 20px;">
                <!-- Google Sign In -->
                <div id="g_id_onload"
                     data-client_id="YOUR_GOOGLE_CLIENT_ID"
                     data-context="signin"
                     data-ux_mode="popup"
                     data-callback="handleSignIn"
                     data-auto_prompt="false">
                </div>
                <div class="g_id_signin"
                     data-type="standard"
                     data-shape="pill"
                     data-theme="outline"
                     data-text="signin_with"
                     data-size="large"
                     data-logo_alignment="left">
                </div>

                <!-- Email/Password Login -->
                <div class="login-form">
                    <input type="email" id="emailInput" placeholder="Email" required aria-label="Email">
                    <input type="password" id="passwordInput" placeholder="Password" required aria-label="Password">
                    <button class="btn" onclick="handleEmailSignIn()">Sign In with Email</button>
                </div>
            </div>

            <!-- User Info -->
            <div id="userInfo" style="display: none; margin-top: 20px;">
                <img id="userPhoto" style="width: 40px; height: 40px; border-radius: 50%; margin-right: 10px;" alt="User Profile">
                <span id="userName"></span>
                <button onclick="signOut()" style="margin-left: 15px; background: #10a37f; color: white; padding: 5px 15px; border-radius: 15px; cursor: pointer;">Sign Out</button>
            </div>

            <!-- Usage Info -->
            <div id="usageInfo" style="display: none; margin-top: 15px; background: #f8f9ff; padding: 15px; border-radius: 10px;">
                <p id="usageText" style="margin: 0; font-size: 0.9rem;"></p>
            </div>
        </section>

        <!-- Main Card (Upload Section) -->
        <section class="main-card" id="mainCard" style="display: none;">
            <div class="upload-section">
                <div class="upload-zone" id="uploadZone">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drop your photo here or click to browse</h3>
                    <p>Supports JPG, PNG, PDF files up to 10MB</p>
                </div>
                <input type="file" id="fileInput" accept="image/*,.pdf" style="display: none;" aria-label="Upload file">
            </div>

            <div class="country-selection">
                <h3>Select Application Type:</h3>
                <select id="countrySelect" aria-label="Select application type">
                    <option value="">Choose application type...</option>
                    <option value="passport">Passport Photo (35x45mm)</option>
                    <option value="id">ID Card Photo (25x35mm)</option>
                    <option value="visa-us">US Visa (51x51mm - 2"x2")</option>
                    <option value="visa-uk">UK Visa (45x35mm)</option>
                    <option value="visa-canada">Canada Visa (35x45mm)</option>
                    <option value="visa-australia">Australia Visa (45x35mm)</option>
                    <option value="cv">CV/Resume Photo (40x50mm)</option>
                    <option value="linkedin">LinkedIn Profile (400x400px)</option>
                </select>

                <div class="specs-display" id="specsDisplay" style="display: none;">
                    <h4>Specifications:</h4>
                    <p id="specsText"></p>
                </div>
            </div>

            <div class="processing" id="processing">
                <h3>Processing your document...</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p>Optimizing image according to specifications</p>
            </div>

            <div class="preview-section" id="previewSection">
                <h3>Preview Result:</h3>
                <div class="preview-grid" id="previewGrid"></div>
            </div>

            <div class="button-row">
                <button class="btn" id="processBtn" disabled>Process</button>
                <button class="btn" id="downloadBtn" disabled>Download</button>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="header">
            <h2>Pricing</h2>
            <div class="pricing">
                <div class="pricing-card">
                    <h3>Free Plan</h3>
                    <div class="price">$0<span style="font-size: 1rem;">/month</span></div>
                    <ul class="features">
                        <li>1 document/day</li>
                        <li>Basic formats</li>
                        <li>Standard processing</li>
                    </ul>
                    <button class="btn" onclick="selectPlan('free')">Select</button>
                </div>
                <div class="pricing-card">
                    <h3>Pro Plan</h3>
                    <div class="price">$9.99<span style="font-size: 1rem;">/month</span></div>
                    <ul class="features">
                        <li>100 documents/month</li>
                        <li>All formats</li>
                        <li>Batch processing</li>
                        <li>Priority support</li>
                    </ul>
                    <button class="btn" onclick="selectPlan('pro')">Upgrade Now</button>
                </div>
                <div class="pricing-card">
                    <h3>Business</h3>
                    <div class="price">$29.99<span style="font-size: 1rem;">/month</span></div>
                    <ul class="features">
                        <li>Unlimited documents</li>
                        <li>Team features</li>
                        <li>API access</li>
                        <li>24/7 support</li>
                    </ul>
                    <button class="btn" onclick="selectPlan('business')">Contact Sales</button>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <p>Try Document Pro free for 7 days, then upgrade to unlock full access!</p>
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="header">
            <h2>Gallery</h2>
            <div style="text-align: center; margin-top: 20px;">
                <p>See the difference Document Pro can make to your photos and documents.</p>
            </div>
            <div class="gallery-grid">
                <img src="example1.jpg" alt="Example 1">
                <img src="example2.jpg" alt="Example 2">
                <img src="example3.jpg" alt="Example 3">
                <img src="example4.jpg" alt="Example 4">
            </div>
        </section>

        <!-- Limit Reached Modal -->
        <div id="limitReachedModal" class="modal">
            <div class="modal-overlay"></div>
            <div class="modal-content">
                <h3>Daily Limit Reached</h3>
                <p>You have reached the maximum number of documents for today.</p>
                <div class="pricing-grid">
                    <div class="pricing-card">
                        <h3>Pro Plan</h3>
                        <div class="price">$9.99<span style="font-size: 1rem;">/month</span></div>
                        <ul class="features">
                            <li>100 documents/month</li>
                            <li>All formats</li>
                            <li>Batch processing</li>
                            <li>Priority support</li>
                        </ul>
                        <button class="btn" onclick="selectPlan('pro')">Upgrade Now</button>
                    </div>
                    <div class="pricing-card">
                        <h3>Business</h3>
                        <div class="price">$29.99<span style="font-size: 1rem;">/month</span></div>
                        <ul class="features">
                            <li>Unlimited documents</li>
                            <li>Team features</li>
                            <li>API access</li>
                            <li>24/7 support</li>
                        </ul>
                        <button class="btn" onclick="selectPlan('business')">Contact Sales</button>
                    </div>
                </div>
                <button onclick="closeLimitModal()" style="margin-top: 20px; background: #ccc; color: #666; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Maybe Later</button>
            </div>
        </div>
    </div>

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Replace with your Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        let currentUser = null;
        let currentPlan = 'free';
        let dailyUsage = 0;

        const signInSection = document.getElementById('signInSection');
        const userInfo = document.getElementById('userInfo');
        const userPhoto = document.getElementById('userPhoto');
        const userName = document.getElementById('userName');
        const usageInfo = document.getElementById('usageInfo');
        const usageText = document.getElementById('usageText');
        const mainCard = document.getElementById('mainCard');
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const countrySelect = document.getElementById('countrySelect');
        const specsDisplay = document.getElementById('specsDisplay');
        const specsText = document.getElementById('specsText');
        const processBtn = document.getElementById('processBtn');
        const processing = document.getElementById('processing');
        const progressFill = document.getElementById('progressFill');
        const previewSection = document.getElementById('previewSection');
        const previewGrid = document.getElementById('previewGrid');
        const downloadBtn = document.getElementById('downloadBtn');

        function scrollToSignIn() {
            document.getElementById('signIn').scrollIntoView({ behavior: 'smooth' });
        }

        function handleSignIn(response) {
            const credential = firebase.auth.GoogleAuthProvider.credential(response.credential);
            auth.signInWithCredential(credential)
                .then(result => {
                    currentUser = result.user;
                    loadUserInfo();
                })
                .catch(error => {
                    console.error('Authentication error:', error);
                });
        }

        function handleEmailSignIn() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            auth.signInWithEmailAndPassword(email, password)
                .then(result => {
                    currentUser = result.user;
                    loadUserInfo();
                })
                .catch(error => {
                    console.error('Authentication error:', error);
                    alert('Sign in failed. Please check your credentials.');
                });
        }

        function loadUserInfo() {
            if (currentUser) {
                userPhoto.src = currentUser.photoURL || 'default-avatar.png';
                userName.textContent = currentUser.displayName || currentUser.email;
                signInSection.style.display = 'none';
                userInfo.style.display = 'flex';
                loadUsageInfo();
            }
        }

        function loadUsageInfo() {
            const usageData = JSON.parse(localStorage.getItem(`usage_${currentUser.id}`)) || {};
            const today = new Date().toDateString();

            if (usageData.date !== today) {
                dailyUsage = 0;
            } else {
                dailyUsage = usageData.count || 0;
            }

            usageText.textContent = `Documents processed today: ${dailyUsage}`;
            usageInfo.style.display = 'block';
            mainCard.style.display = 'block';
        }

        function signOut() {
            auth.signOut().then(() => {
                currentUser = null;
                signInSection.style.display = 'block';
                userInfo.style.display = 'none';
                usageInfo.style.display = 'none';
                mainCard.style.display = 'none';
            }).catch(error => {
                console.error('Sign-out error:', error);
            });
        }

        function handleCountryChange() {
            const value = countrySelect.value;
            specsDisplay.style.display = value ? 'block' : 'none';
            if (!value) {
                processBtn.disabled = true;
                specsText.textContent = '';
                return;
            }

            const specs = getSpecs(value);
            specsText.textContent = `
                ${specs.width}x${specs.height} ${specs.unit} at ${specs.dpi} DPI
                - Background: ${specs.background}
            `;
            processBtn.disabled = false;
        }

        function getSpecs(type) {
            switch (type) {
                case 'passport':
                    return { width: 35, height: 45, unit: 'mm', dpi: 300, background: 'white' };
                case 'id':
                    return { width: 25, height: 35, unit: 'mm', dpi: 300, background: 'white' };
                case 'visa-us':
                    return { width: 51, height: 51, unit: 'mm', dpi: 300, background: 'white' };
                case 'visa-uk':
                    return { width: 45, height: 35, unit: 'mm', dpi: 300, background: 'white' };
                case 'visa-canada':
                    return { width: 35, height: 45, unit: 'mm', dpi: 300, background: 'white' };
                case 'visa-australia':
                    return { width: 45, height: 35, unit: 'mm', dpi: 300, background: 'white' };
                case 'cv':
                    return { width: 40, height: 50, unit: 'mm', dpi: 300, background: 'light' };
                case 'linkedin':
                    return { width: 400, height: 400, unit: 'px', dpi: 72, background: 'any' };
                default:
                    return { width: 0, height: 0, unit: 'mm', dpi: 300, background: 'white' };
            }
        }

        function processFile() {
            if (!checkUsageLimit()) {
                return;
            }

            const file = fileInput.files[0];
            if (!file) {
                alert('Please select a file first.');
                return;
            }

            const specs = getSpecs(countrySelect.value);
            processing.style.display = 'block';
            progressFill.style.width = '0%';

            fakeProcess(file, specs).then(result => {
                processing.style.display = 'none';
                progressFill.style.width = '0%';

                processedFile = result;
                showPreview();
                incrementUsage();
            }).catch(error => {
                console.error('Processing error:', error);
                alert('Failed to process the file. Please try again.');
                processing.style.display = 'none';
                progressFill.style.width = '0%';
            });
        }

        function fakeProcess(file, specs) {
            return new Promise(resolve => {
                progressFill.style.width = '100%';

                setTimeout(() => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();

                    img.onload = function() {
                        const pixelWidth = specs.unit === 'mm' ?
                            (specs.width * specs.dpi) / 25.4 : specs.width;
                        const pixelHeight = specs.unit === 'mm' ?
                            (specs.height * specs.dpi) / 25.4 : specs.height;

                        canvas.width = pixelWidth;
                        canvas.height = pixelHeight;

                        if (specs.background === 'white') {
                            ctx.fillStyle = '#FFFFFF';
                        } else if (specs.background === 'neutral') {
                            ctx.fillStyle = '#F0F0F0';
                        } else if (specs.background === 'light') {
                            ctx.fillStyle = '#F8F8F8';
                        }

                        if (specs.background !== 'any') {
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                        }

                        const scale = Math.max(
                            canvas.width / img.width,
                            canvas.height / img.height
                        );

                        const scaledWidth = img.width * scale;
                        const scaledHeight = img.height * scale;
                        const x = (canvas.width - scaledWidth) / 2;
                        const y = (canvas.height - scaledHeight) / 2;

                        ctx.drawImage(img, x, y, scaledWidth, scaledHeight);

                        canvas.toBlob((blob) => {
                            resolve({
                                name: file.name.replace(/\.[^/.]+$/, '_optimized.jpg'),
                                blob: blob,
                                url: URL.createObjectURL(blob),
                                originalName: file.name
                            });
                        }, 'image/jpeg', 0.9);
                    };

                    img.src = URL.createObjectURL(file);
                }, 1000);
            });
        }

        function showPreview() {
            previewGrid.innerHTML = '';

            const previewCard = document.createElement('div');
            previewCard.className = 'preview-card';
            previewCard.innerHTML = `
                <h4>Before</h4>
                <img src="${URL.createObjectURL(selectedFile)}" alt="Original">
                <h4 style="margin-top: 20px;">After</h4>
                <img src="${processedFile.url}" alt="Optimized">
                <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                    ${processedFile.name}
                </p>
            `;
            previewGrid.appendChild(previewCard);

            previewSection.style.display = 'block';
            processBtn.disabled = false;
        }

        function downloadFile() {
            const a = document.createElement('a');
            a.href = processedFile.url;
            a.download = processedFile.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function selectPlan(plan) {
            if (plan === 'free') {
                alert('You are now using the free plan! Process 1 document per day.');
                return;
            }

            if (plan === 'business') {
                alert('Please contact sales@documentpro.com for business inquiries.');
                return;
            }

            if (plan === 'pro') {
                if (!currentUser) {
                    alert('Please sign in first to upgrade your plan.');
                    return;
                }

                const priceId = 'price_1234567890'; // Replace with your price ID

                stripe.redirectToCheckout({
                    lineItems: [{
                        price: priceId,
                        quantity: 1,
                    }],
                    mode: 'subscription',
                    customerEmail: currentUser.email,
                    successUrl: window.location.origin + '/success.html',
                    cancelUrl: window.location.origin + '/cancel.html',
                }).then(function (result) {
                    if (result.error) {
                        alert('Payment failed: ' + result.error.message);
                    }
                });
            }
        }

        const selectedFile = null;
        let processedFile = null;

        const today = new Date().toDateString();
        let usageData = JSON.parse(localStorage.getItem(`usage_${currentUser?.id}`)) || {};
        if (usageData.date !== today) {
            dailyUsage = 0;
        } else {
            dailyUsage = usageData.count || 0;
        }

        function incrementUsage() {
            dailyUsage += 1;
            usageText.textContent = `Documents processed today: ${dailyUsage}`;
            const usageData = {
                date: today,
                count: dailyUsage
            };
            localStorage.setItem(`usage_${currentUser.id}`, JSON.stringify(usageData));
        }

        function checkUsageLimit() {
            if (currentPlan === 'free' && dailyUsage >= 1) {
                const modal = document.getElementById('limitReachedModal');
                modal.style.display = 'block';
                requestAnimationFrame(() => modal.classList.add('show'));
                return false;
            }
            return true;
        }

        function closeLimitModal() {
            const modal = document.getElementById('limitReachedModal');
            modal.classList.remove('show');
            setTimeout(() => { modal.style.display = 'none'; }, 300);
        }

        // Event listeners
        uploadZone.addEventListener('click', () => fileInput.click());
        uploadZone.addEventListener('dragover', handleDragOver);
        uploadZone.addEventListener('drop', handleDrop);
        uploadZone.addEventListener('dragleave', handleDragLeave);
        fileInput.addEventListener('change', handleFileSelect);
        countrySelect.addEventListener('change', handleCountryChange);
        processBtn.addEventListener('click', processFile);
        downloadBtn.addEventListener('click', downloadFile);

        function handleDragOver(e) {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const files = e.dataTransfer.files;
            fileInput.files = files;
        }

        function handleDragLeave() {
            uploadZone.classList.remove('dragover');
        }

        function handleFileSelect() {
            const files = fileInput.files;
            if (!files.length) {
                return;
            }
            selectedFile = files[0];
            processBtn.disabled = false;
        }

        window.addEventListener('load', function() {
            console.log('Document Pro initialized successfully!');
        });
    </script>
</body>
</html>
